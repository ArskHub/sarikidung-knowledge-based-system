{% extends "base.html" %}

{% block title %}Kidung Library - Digital Archive{% endblock %}

{% block content %}
<header style="background: var(--dark); padding: 80px 0; text-align: center; color: white; border-bottom: 3px solid var(--gold);">
    <div class="animate">
        <h1 style="font-family: 'Playfair Display', serif; font-size: 2.5rem; color: var(--gold);">Kidung Digital Library</h1>
        <p style="opacity: 0.8; max-width: 700px; margin: 10px auto; font-size: 1.1rem;">
            Eksplorasi seluruh basis data Kidung Panca Yadnya yang tersimpan dalam sistem Ontologi.
        </p>
    </div>
</header>

<div class="container">
    <div class="glass-card animate" style="margin-bottom: 30px; padding: 30px;">
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px;">
            <div style="flex: 1; min-width: 300px;">
                <label style="font-size: 0.8rem; letter-spacing: 1px; color: var(--gold);">SEARCH ARCHIVE</label>
                <input type="text" id="searchInput" onkeyup="searchTable()" placeholder="Cari nama kidung, jenis yadnya, atau upacara..." 
                       style="width: 100%; padding: 12px 20px; border-radius: 50px; border: 1px solid #ddd; outline: none; margin-top: 5px; font-family: 'Poppins';">
            </div>
            <div style="text-align: right;">
                <p style="font-size: 0.9rem; color: var(--dark-light);">Total Koleksi: <strong>{{ kidungs|length }} Kidung</strong></p>
            </div>
        </div>
    </div>

    <div class="glass-card animate" style="padding: 0; overflow: hidden; border: none; box-shadow: var(--shadow);">
        <table id="kidungTable" style="width: 100%; border-collapse: collapse; background: white;">
            <thead>
                <tr style="background: var(--dark); color: var(--gold); text-align: left; font-family: 'Playfair Display'; font-size: 1.1rem;">
                    <th style="padding: 20px 25px; border-bottom: 2px solid var(--gold);">#</th>
                    <th style="padding: 20px 25px; border-bottom: 2px solid var(--gold);">Kidung Name</th>
                    <th style="padding: 20px 25px; border-bottom: 2px solid var(--gold);">Yadnya Category</th>
                    <th style="padding: 20px 25px; border-bottom: 2px solid var(--gold);">Ceremony</th>
                    <th style="padding: 20px 25px; border-bottom: 2px solid var(--gold);">Action</th>
                </tr>
            </thead>
            <tbody>
                {% for k in kidungs %}
                <tr class="table-row" style="border-bottom: 1px solid #eee; transition: all 0.3s;">
                    <td style="padding: 20px 25px; color: var(--gold); font-weight: bold;">{{ loop.index }}</td>
                    <td style="padding: 20px 25px;">
                        <span style="font-weight: 600; color: var(--dark);">{{ k.target.replace('_', ' ') }}</span>
                    </td>
                    <td style="padding: 20px 25px;">
                        <span style="background: var(--cream); color: var(--dark-light); padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; border: 1px solid rgba(212,175,55,0.3);">
                            {{ k.yadnya }}
                        </span>
                    </td>
                    <td style="padding: 20px 25px; color: #666;">{{ k.upacara }}</td>
                    <td style="padding: 20px 25px;">
                        <a href="{{ url_for('browsing') }}" class="btn-predict" style="padding: 8px 15px; font-size: 0.75rem; text-decoration: none; display: inline-block; width: auto; border-radius: 5px;">
                            DETAILS
                        </a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="noResult" style="display: none; text-align: center; padding: 50px;">
        <p style="color: var(--dark-light); font-style: italic;">Data kidung tidak ditemukan...</p>
    </div>
</div>

<style>
    .table-row:hover {
        background-color: var(--cream) !important;
        transform: scale(1.005);
        box-shadow: inset 4px 0 0 var(--gold);
    }
    
    #searchInput:focus {
        border-color: var(--gold) !important;
        box-shadow: 0 0 10px rgba(212, 175, 55, 0.2);
    }
</style>

<script>
function searchTable() {
    var input, filter, table, tr, td, i, j, txtValue, found;
    input = document.getElementById("searchInput");
    filter = input.value.toUpperCase();
    table = document.getElementById("kidungTable");
    tr = table.getElementsByTagName("tr");
    let noResult = document.getElementById("noResult");
    let visibleCount = 0;

    for (i = 1; i < tr.length; i++) {
        tr[i].style.display = "none";
        td = tr[i].getElementsByTagName("td");
        found = false;
        for (j = 0; j < td.length; j++) {
            if (td[j]) {
                txtValue = td[j].textContent || td[j].innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    found = true;
                    break;
                }
            }
        }
        if (found) {
            tr[i].style.display = "";
            visibleCount++;
        }
    }
    noResult.style.display = (visibleCount === 0) ? "block" : "none";
}
</script>
{% endblock %}